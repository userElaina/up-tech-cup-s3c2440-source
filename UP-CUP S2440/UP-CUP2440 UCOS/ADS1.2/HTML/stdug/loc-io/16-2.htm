<HTML><HEAD><TITLE>16.2 An Example</TITLE></HEAD>
<BODY BGCOLOR=#FFFFFF>
<A HREF="../index.htm"><IMG SRC="images/banner.gif" WIDTH=405 HEIGHT=57 ALT="Rogue Wave banner" BORDER=0></A><BR>
<A HREF="16-1.htm"><IMG SRC="images/prev.gif" WIDTH=20 HEIGHT=21 ALT="Previous file" BORDER=0></A><A HREF="index.htm"><IMG SRC="images/top.gif" WIDTH=56 HEIGHT=21 ALT="Top of Document" BORDER=O></A><A HREF="booktoc.htm"><IMG SRC="images/toc.gif" WIDTH=56 HEIGHT=21 ALT="Contents" BORDER=0></A><A HREF="tindex.htm"><IMG SRC="images/index.gif" WIDTH=56 HEIGHT=21 ALT="Index" BORDER=0></A><A HREF="17.htm"><IMG SRC="images/next.gif" WIDTH=19 HEIGHT=21 ALT="Next file" BORDER=0></A>
<H2>16.2 An Example</H2>

<A NAME="idx412"><!></A>
<P>A program can register a callback function on a particular stream as follows:</P>
<UL>
<PRE>
// Callback function
void show_event(ios_base::event e, iosbase&amp; io, int index)
{
  if (e == ios_base::imbue_event)
    cout &lt;&lt; "imbue called" &lt;&lt; endl;
  else if (e == ios_base::erase_event)
    cout &lt;&lt; "stream destroyed" &lt;&lt; endl;
  else
    cout &lt;&lt; "cpyfmt called" &lt;&lt; endl;
}

ostringstream s;
s.register_callback(my_callback,0);   //1
s.imbue(locale::global());            //2  </PRE>
</UL>
<TABLE CELLPADDING="3">

<TR VALIGN="top"><TD>//1</TD><TD>The function <SAMP>show_event</SAMP> is now called with either <SAMP>ios_base::erase_event</SAMP>, <SAMP>ios_base::imbue_event</SAMP>, or <SAMP>ios_base::copyfmt_event</SAMP> as the first argument, depending on whether the destruction of the stream, the imbuing of a new locale, or a call to <SAMP>cpyfmt</SAMP> initiated the callback. 
<TR VALIGN="top"><TD>//2</TD><TD>This causes <SAMP>show_event</SAMP> to be called. The first argument is <SAMP>ios_base::imbue_event</SAMP>; the second argument is a reference to the stream where the event occurred, which is <SAMP>s</SAMP> in this case; and the third argument is always the index provided in the call to <SAMP>register_callback</SAMP>, which is <SAMP>0</SAMP> in this case.
<BR><BR>If more than one function is registered, functions are called in the opposite order of registration. 
</TABLE>
<P>Please refer to <A HREF="5-9.htm#592">Section 5.9.2</A> for an example using callback functions with a user-defined stream inserter.</P>


<BR>
<HR>
<A HREF="16-1.htm"><IMG SRC="images/prev.gif" WIDTH=20 HEIGHT=21 ALT="Previous file" BORDER=0></A><A HREF="index.htm"><IMG SRC="images/top.gif" WIDTH=56 HEIGHT=21 ALT="Top of Document" BORDER=O></A><A HREF="booktoc.htm"><IMG SRC="images/toc.gif" WIDTH=56 HEIGHT=21 ALT="Contents" BORDER=0></A><A HREF="tindex.htm"><IMG SRC="images/index.gif" WIDTH=56 HEIGHT=21 ALT="Index" BORDER=0></A><A HREF="17.htm"><IMG SRC="images/next.gif" WIDTH=19 HEIGHT=21 ALT="Next file" BORDER=0></A><P>OEM Edition, OEM Edition, &copy;Copyright 1999, Rogue Wave Software, Inc.<BR><A HREF="contact.htm">Contact</A> Rogue Wave about documentation or support issues.</P>
</BODY></HTML>
